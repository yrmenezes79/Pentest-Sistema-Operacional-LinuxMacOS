#!/bin/bash

# Atualiza a lista de pacotes
sudo dnf update -y

# Instalação dos pacotes necessários
sudo dnf install -y httpd mod_ssl openssh-server vsftpd bind-utils mariadb-server postgresql-server

dnf module install postgresql:15/server

postgresql-setup --initdb

# Habilita e inicia os serviços necessários
sudo systemctl enable httpd
sudo systemctl start httpd

sudo systemctl enable sshd
sudo systemctl start sshd

sudo systemctl enable vsftpd
sudo systemctl start vsftpd

sudo systemctl enable mariadb
sudo systemctl start mariadb

systemctl enable postgresql.service
systemctl start postgresql.service

# Abre as portas necessárias no firewall
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --permanent --add-port=22/tcp
sudo firewall-cmd --permanent --add-port=25/tcp
sudo firewall-cmd --permanent --add-port=465/tcp
sudo firewall-cmd --permanent --add-port=587/tcp
sudo firewall-cmd --permanent --add-port=21/tcp
sudo firewall-cmd --permanent --add-port=989/tcp
sudo firewall-cmd --permanent --add-port=990/tcp
sudo firewall-cmd --permanent --add-port=110/tcp
sudo firewall-cmd --permanent --add-port=143/tcp
sudo firewall-cmd --permanent --add-port=23/tcp
sudo firewall-cmd --permanent --add-port=53/tcp
sudo firewall-cmd --permanent --add-port=3306/tcp
sudo firewall-cmd --permanent --add-port=5432/tcp

# Recarrega as regras do firewall
sudo firewall-cmd --reload
