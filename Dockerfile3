# Usar uma imagem base oficial e atualizada
FROM ubuntu:20.04

# Manter o sistema atualizado
RUN apt-get update && apt-get upgrade -y && apt-get install -y --no-install-recommends \
    wget \
    curl \
    ca-certificates \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Criar um usuário não privilegiado
RUN useradd -m myuser

# Copiar scripts ou arquivos necessários com permissões seguras
COPY secure-script.sh /usr/local/bin/secure-script.sh
RUN chmod 755 /usr/local/bin/secure-script.sh

# Trocar para o usuário não privilegiado
USER myuser

# Definir diretório de trabalho
WORKDIR /home/myuser

# Evitar expor portas desnecessárias
# EXPOSE 8080 (Apenas se necessário)

# Definir variáveis de ambiente de forma segura
ENV MY_ENV_VAR="safe_value"

# Copiar o aplicativo para o contêiner
COPY . /home/myuser/app

# Definir o ponto de entrada seguro
ENTRYPOINT ["/usr/local/bin/secure-script.sh"]

# Definir CMD se necessário
# CMD ["argumentos para o script"]
